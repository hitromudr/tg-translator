### TG-TRANSLATOR META-RULES v1.0 (Strategy First) ###
# Status: ACTIVE
# Description: This file contains the absolute minimum of core strategic principles that define the Agent's philosophy.
# All tactical and procedural instructions have been moved to docs/process/OPERATING_PROCEDURES.md.

@@@@ ПРОЕКТ НАХОДИТСЯ В СТАДИИ ИНИЦИАЛИЗАЦИИ. ИНСТРУМЕНТЫ ВАЛИДИРУЮЩИЕ ПРОЦЕССЫ МОГУТ БЫТЬ ЕЩЕ НЕ СОЗДАНЫ.

$$$ МЕТАПРАВИЛО 0: ЛОГИКА ДИСПЕТЧЕРА. ЛЮБАЯ СЕССИЯ НАЧИНАЕТСЯ С АКТИВАЦИИ ЛОГИКИ "ДИСПЕТЧЕРА СЕССИЙ". ВСЕ ДЕЙСТВИЯ, ОСОБЕННО ИНИЦИАЛИЗАЦИЯ, ДОЛЖНЫ СТРОГО СЛЕДОВАТЬ ПРОЦЕДУРАМ.

$$$ МЕТАПРАВИЛО А: ОТВЕЧАТЬ ПО РУССКИ. КОММЕНТАРИИ В КОДЕ ПИСАТЬ НА АНГЛИЙСКОМ
$$$ МЕТАПРАВИЛО Б: НЕ ИСПОЛЬЗОВАТЬ ЭМОЦИОНАЛНУЮ ЛЕКСИКУ, ТИПА ФИНАЛЬНЫЙ, ТОЧНО ФИНАЛЬНЫЙ, ПОСЛЕДНИЙ, ТОЧНО ПОСЛЕДНИЙ
$$$ МЕТАПРАВИЛО В: НЕ МОЛЧАТЬ. ЕСЛИ БЫЛА ОШИБКА - ДОЛОЖИ О НЕЙ. Ошибки оболочки bash (command not found, permission denied и т.д.) при вызове terminal считаются такими же критическими ошибками, как и ошибки самих инструментов. Tool canceled by user - ЭТО БАГ. ОБРАЩАЙСЯ К ПОЛЬЗОВАТЕЛЮ.
$$$ МЕТАПРАВИЛО Г: НЕ ИСПОЛЬЗОВАТЬ СЛОВА "ВСЕГДА", "НИКОГДА", "ВСЕГДА НЕ", "НИКОГДА НЕ"
$$$ МЕТАПРАВИЛО Д: ПРОТОКОЛ СМЕНЫ РОЛИ.
1.  **САМОСТОЯТЕЛЬНАЯ ИНИЦИАТИВА АГЕНТА:** Если задача не соответствует текущей роли, агент обязан предложить новую роль и дождаться явного разрешения от пользователя.
2.  **ПРЯМОЕ УКАЗАНИЕ ПОЛЬЗОВАТЕЛЯ:** Если пользователь явно указывает новую роль (например, "смени роль на X"), агент должен немедленно принять эту роль без дополнительного подтверждения, кратко уведомив о смене.

---

### 0. ⭐ ПРАВИЛО №0: ЗАПРЕТ ДЕСТРУКТИВНЫХ ДЕЙСТВИЙ ⭐
- **ДЕЙСТВИЕ:** Агенту **категорически запрещено** выполнять деструктивные операции (удаление/полная перезапись файлов, удаление веток git) без явного, однозначного разрешения от пользователя.
- **ОБОСНОВАНИЕ:** Предотвращение необратимой потери данных из-за неверной гипотезы агента. "Не предполагай" > "Действуй быстро".

### 0.5. ⭐ ПРИНЦИП "АВТОНОМНОГО АНАЛИЗА" (AUTONOMOUS ANALYSIS) ⭐
- **ДЕЙСТВИЕ 0.5.1 (Чтение и Диагностика):** Агенту **категорически запрещено запрашивать разрешение** на выполнение любых действий, которые не изменяют состояние системы (чтение файлов, поиск, листинг директорий, запуск тестов и т.д.). Такие операции должны выполняться автономно.
- **ДЕЙСТВИЕ 0.5.2 (Создание Артефактов Анализа):** Агенту **разрешено без дополнительного запроса** создавать файлы и директории, являющиеся прямым результатом аналитической работы (например, файлы `post-mortem`, `retrospective-analysis`, временные файлы для хранения логов), при условии, что они создаются в специально отведенных для этого директориях (`docs/process/post-mortems`, `tmp/`).
- **ОБОСНОВАНИЕ:** Ускорение цикла "гипотеза-проверка-вывод". Разрешение требуется только для действий, изменяющих *исходный код, конфигурацию или критически важную документацию*. Создание артефактов анализа является частью процесса "проверки" и должно выполняться автономно.

### 1. ⭐ ПРОТОКОЛ "АВТОМАТИЗИРОВАННОЙ ИНИЦИАЛИЗАЦИИ" (AUTOMATED INITIALIZATION) ⭐
- **ДЕЙСТВИЕ:** Любая рабочая сессия **обязана** начинаться с немедленного выполнения команды `make session-init` (если доступна). Агенту **категорически запрещено** выполнять любые другие действия (`git status`, `read_file`) до получения отчета от этого инструмента.

### 1.6. ⭐ ПРИНЦИП "ПРИОРИТЕТА ПРОЦЕССА" (PROCESS FIRST) ⭐
- **ДЕЙСТВИЕ:** Если в бэклоге одновременно существуют задачи по улучшению процесса (например, `refactor(process)`) и задачи по развитию продукта (например, `feat(api)`), агент **обязан** выбрать для работы по улучшению процесса.
- **ОБОСНОВАНИЕ:** Стабильный и эффективный процесс является фундаментом для качественной разработки продукта. Устранение "трещин в фундаменте" всегда важнее, чем постройка "новых стен".

### 1.8. ⭐ ПРОТОКОЛ "ПРИОРИТЕТА ЗАДАЧ" (TASK PRIORITY PROTOCOL) ⭐
- **ДЕЙСТВИЕ:** При получении команды на начало работы без явного указания ID, агент обязан следовать строгому порядку приоритетов для определения следующей задачи.
- **ПОСЛЕДОВАТЕЛЬНОСТЬ:**
    1.  **Анализ Текущей Задачи (`current`):** Агент **обязан** в первую очередь проверить директорию `docs/tasks/current/`. Если там находится задача, он должен предложить продолжить работу над ней.
    2.  **Анализ Бэклога (`backlog`):** Только если директория `current/` пуста, агент обязан просканировать директорию `docs/tasks/backlog/`.
    3.  **Приоритизация Бэклога:** При выборе задачи из бэклога агент следует "Принципу Приоритета Процесса" (Правило 1.6).
    4.  **Предложение:** Агент обязан предложить пользователю наиболее приоритетную задачу (из `current` или `backlog`) и получить явное согласие перед ее запуском.

### 1.9. ⭐ ПРОТОКОЛ "ПРИОСТАНОВКИ ЗАДАЧИ" (TASK PAUSE PROTOCOL) ⭐
- **ДЕЙСТВИЕ:** Если работа над задачей прерывается на конец сессии, но будет продолжена позже, агенту **категорически запрещено** использовать `make cancel-task`. Правильной процедурой является:
    1.  Закоммитить все текущие изменения на фича-ветке с информативным сообщением (например, `wip(task): pause session`).
    2.  Завершить сессию. Текущая фича-ветка и активная задача остаются в состоянии "In Progress".

### 4. ⭐ ЗОЛОТОЕ ПРАВИЛО (GOLDEN RULE) ⭐
- **ДЕЙСТВИЕ 4.1: НЕ ПРЕДПОЛАГАЙ.** Любая гипотеза требует проверки.
- **ДЕЙСТВИЕ 4.2: СНАЧАЛА ТЕСТЫ.** Никакая новая или измененная функциональность не может быть принята без покрывающего ее теста.

### 4.2.5. ⭐ ПРОТОКОЛ "АВТОМАТИЗИРОВАННОЙ ВАЛИДАЦИИ ТЕСТОВ" (AUTOMATED TEST VALIDATION) ⭐
- **ДЕЙСТВИЕ 4.2.5.1 (ЗАПУСК И ЛОГИРОВАНИЕ):** После внесения любых изменений в кодовую базу, агент **обязан** запустить соответствующую команду для запуска тестов. Вывод (`stdout` и `stderr`) этой команды **обязан** быть перенаправлен в лог-файл в директории `tmp/`.
- **ДЕЙСТВИЕ 4.2.5.2 (АНАЛИЗ ЛОГА):** Агенту **категорически запрещено** делать выводы об успехе или провале тестов на основе кода возврата (`exit code`) команды. Сразу после выполнения команды агент **обязан** выполнить полное чтение сгенерированного лог-файла.
- **ДЕЙСТВИЕ 4.2.5.3 (КРИТЕРИИ УСПЕХА):** Успешным считается **только** тот запуск тестов, в логе которого явно присутствует строка, подтверждающая, что **все тесты пройдены**, и **отсутствуют** любые сообщения об ошибках (`failed`, `error`).

### 4.5. ⭐ ПРОТОКОЛ ИТЕРАТИВНОЙ ОТЛАДКИ (ITERATIVE DEBUGGING PROTOCOL) ⭐
- **ДЕЙСТВИЕ:** Если 2 последовательные попытки исправить падающий тест на основе гипотезы не увенчались успехом, агенту **категорически запрещено** делать третью попытку "вслепую". Обязательным следующим шагом является переход в режим сбора данных (логирование).

### 4.7. ⭐ ПРИНЦИП ГАРАНТИРОВАННОГО ЗАВЕРШЕНИЯ (GUARANTEED COMPLETION) ⭐
- **ДЕЙСТВИЕ:** Все команды, изменяющие состояние (`start`, `verify`, `finalize`, `switch`, `cancel`), **обязаны** быть идемпотентными.

### 6. ⭐ ПРИНЦИП "ДОВЕРЯЙ, НО ПРОВЕРЯЙ" (VERIFY, DON'T ASSUME) ⭐
- **ДЕЙСТВИЕ 6.1 (ПРОТОКОЛ ВЫСШЕЙ ИСТИНЫ): ПЕРЕКРЕСТНАЯ ПРОВЕРКА ИНСТРУМЕНТОВ.** Если результат работы нативного инструмента ФС (`list_directory`, `find_path`, `grep`) кажется неожиданным или противоречивым, агент **обязан** немедленно выполнить перекрестную проверку с помощью `terminal ls -R <path>`. Результат `ls -R` считается **абсолютным источником правды** о состоянии файловой системы.
- **ДЕЙСТВИЕ 6.5: ПРОЧИТАЙ ПРЕЖДЕ ЧЕМ ПИСАТЬ.** Агенту **категорически запрещено** использовать инструмент `edit_file` (в режимах `edit` или `overwrite`) без предварительного успешного выполнения `read_file` для этого же самого пути в рамках текущей цепочки рассуждений.

### 6.6. ⭐ ПРОТОКОЛ "ВЕРИФИЦИРОВАННОГО ПУТИ" (VERIFIED PATH PROTOCOL) ⭐
- **ДЕЙСТВИЕ 6.6.1 (ЗАХВАТ):** После успешного выполнения инструмента, который возвращает путь к файлу или директории (`find_path`, `grep`, `ls`), агент **обязан** немедленно сохранить **точную, полную строку** этого пути в своей рабочей памяти как "последний верифицированный путь".
- **ДЕЙСТВИЕ 6.6.2 (СТРОГОЕ ИСПОЛЬЗОВАНИЕ):** При вызове любого инструмента, принимающего путь в качестве аргумента (`read_file`, `edit_file`, `terminal cd`), агент **обязан** использовать **исключительно** путь, сохраненный на шаге 6.6.1. Любая ручная модификация, перепечатывание или восстановление пути из памяти категорически запрещены.

### 6.7. ⭐ ПРОТОКОЛ "ДВУХКОНТЕКСТНЫХ ПУТЕЙ" (DUAL-CONTEXT PATH PROTOCOL) ⭐
- **ДЕЙСТВИЕ 6.7.1 (НАТИВНЫЕ ИНСТРУМЕНТЫ):** При использовании **нативных инструментов** (`read_file`, `edit_file`, `list_directory` и т.д.), путь **обязан** быть абсолютным относительно корня проекта и **всегда** начинаться с имени корневой директории (например, `tg-translator/src/main.py`). Использование относительных путей (`./`, `../`) **категорически запрещено**.
- **ДЕЙСТВИЕ 6.7.2 (СИСТЕМНАЯ ОБОЛОЧКА):** При использовании инструмента `terminal`, корневая директория проекта **обязана** быть указана в параметре `cd`. В самом параметре `command` должны использоваться **стандартные относительные пути** (`./`, `scripts/`, `../`), как если бы вы работали в обычном терминале.

### 7. МЕТА-ПРАВИЛО: АКТУАЛЬНОСТЬ ПРАВИЛ (RULESET AWARENESS)
- **ДЕЙСТВИЕ:** Сразу после любого изменения этого файла (`.rules`), агент **обязан** немедленно перечитать его.

### 15. ⭐ ПРОТОКОЛ "ХРАНИТЕЛЯ" (GUARDIAN PROTOCOL) ⭐
- **ДЕЙСТВИЕ 15.1: ЗАПРЕТ ПРЯМОГО ВЫЗОВА GIT.** Агенту **категорически запрещено** напрямую вызывать `git` через инструмент `terminal`. Все операции с Git **обязаны** выполняться исключительно через обертку `scripts/guardian.py` (если доступна, иначе с осторожностью и проверкой статуса).